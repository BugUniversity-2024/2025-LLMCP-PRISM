# PRISM 项目对话式编程过程展示

> 本文档整理了 PRISM 项目开发过程中的关键对话片段，展示了如何通过对话式编程方式完成项目开发

## 📋 目录

- [阶段1：需求讨论与技术选型](#阶段1需求讨论与技术选型)
- [阶段2：项目初始化与架构搭建](#阶段2项目初始化与架构搭建)
- [阶段3：UI/UX迭代优化](#阶段3uiux迭代优化)
- [阶段4：真实API集成](#阶段4真实api集成)
- [阶段5：Prompt工程优化](#阶段5prompt工程优化)
- [关键技术决策总结](#关键技术决策总结)

---

## 阶段1：需求讨论与技术选型

### 💬 对话片段 #1 - 项目定位讨论

**User (1547):**
```
1548 看看我们这个项目的一个计划文件，你觉得如何，我们主要是做功能设计 + 功能分析 + 拆解还有技术栈选型。我们一起热烈讨论一下，不要着急出方案
```

**关键决策点：**
- 不急于实现，先充分讨论
- 明确项目定位：Prompt优化中间层
- 目标：在用户与绘图API之间提供智能Prompt优化

---

### 💬 对话片段 #2 - 核心功能定义

**User (1547):**
```
主要是现在的模型比如 seedream 还有 gemini，他也是支持自然语言绘图的（也就是说，你可以给一张图片上去，然后说 "请帮我调亮这个图片"），我们的定位就是在用户和 gemini（或者别的）做一个中间层，在中间层使用 如 （GPT-4o）等模型去优化提示词。我们会给一个固定的提示词模版当作 （RAG）
```

**技术亮点：**
- 🎯 定位清晰：PAAS平台，提供Prompt优化服务
- 🔧 技术方案：LLM作为中间层优化用户输入
- 📚 采用RAG：固定提示词模版作为知识库

---

## 阶段2：项目初始化与架构搭建

### 💬 对话片段 #3 - 技术栈选型

**User (1547):**
```
我觉得可以，先帮我 init 一下吧，只要 init 就行了。所有的包增加都要使用包管理器，前端使用 pnpm 或者 bun，你来决定。后端 python 使用 uv。先暂时做这些
```

**User (1547):**
```
你来吧，用 tailwindcss 还有 shadcn，我觉得比较好
```

**User (1547):**
```
注意 tailwindcss 是 v4 版本
```

**技术栈决策：**
- ✅ 前端：Bun + React + Tailwind CSS v4 + shadcn/ui
- ✅ 后端：Python + uv + FastAPI
- ✅ 包管理：现代化工具链（Bun/uv）

**对话式编程体现：**
- 用户通过自然语言明确技术栈要求
- AI理解并执行初始化任务
- 协作决策：用户提供方向，AI执行实现

---

### 💬 对话片段 #4 - 图标库选择

**User (1547):**
```
前端用 svg 的部分能否换成 heroicon
```

**优化点：**
- 统一图标库选择
- 注重项目规范性
- 细节优化体现工程化思维

---

## 阶段3：UI/UX迭代优化

### 💬 对话片段 #5 - 发现UI问题

**User (1547):**
```
[Image #1]目前的页面样式很有问题，感觉就和三大件一样。探索是什么问题导致的，然后再修复
```

**问题诊断：**
- 用户提供截图反馈
- UI缺乏现代感和层次
- 需要重新设计视觉风格

---

### 💬 对话片段 #6 - UI重构讨论

**User (1547):**
```
然后目前我们的前端有点丑陋，没能很好的体现一个应用程序 prompt 优化工具的感觉，有什么方案吗，而且很杂乱
```

**User (1547):**
```
1548 看看我们的 UI，我感觉很丑而且不好看，你有什么想法
```

**User (1547):**
```
提升视觉层次 动画和交互 细节优化 更好的布局
```

**User (1547):**
```
请你设计吧
```

**设计改进方向：**
- 🎨 提升视觉层次
- ✨ 添加动画和交互效果
- 🔍 细节优化
- 📐 改进布局结构

**对话式编程体现：**
- 多轮迭代讨论UI方案
- 用户提出问题→AI分析→用户确认→AI实现
- 协作式设计决策

---

### 💬 对话片段 #7 - UI优化完成反馈

**User (1547):**
```
我感觉十分不错的啊～很棒！然后看看我们的 docs，目前我们都只是一个 mock 后端。如果要完全实现我们这个项目的话，能否请你先调查一下
```

**成果验收：**
- ✅ UI优化获得认可
- 🔄 准备进入下一阶段：真实API集成

---

## 阶段4：真实API集成

### 💬 对话片段 #8 - 数据库选型调整

**User (1547):**
```
我建议不用 postgresql，暂时先使用 sqlite
```

**技术决策优化：**
- 从PostgreSQL改为SQLite
- 降低部署复杂度
- 适合项目规模

---

### 💬 对话片段 #9 - API配置灵活化

**User (1547):**
```
因为我们应该不使用官方的 api，我希望你能够加上一下 API Base 配置，以及更新一下 example 吧
```

**功能扩展：**
- 支持自定义API Base
- 兼容第三方API代理
- 提高系统灵活性

---

### 💬 对话片段 #10 - 版本管理功能设计

**User (1547):**
```
然后看一下我们的前后端，似乎存在一个严重的问题，就是我们的之前生成的图片和历史，会被直接刷新后在前端删除。用户看不到之前画了什么图
```

**User (1547):**
```
要不看一下后端能不能传回来？我想的是版本管理和项目的形式。可以开多个项目，每个项目有单独的版本管理
```

**重要功能迭代：**
- 🔍 发现核心问题：刷新后数据丢失
- 💡 提出解决方案：版本管理 + 项目管理
- 📊 设计思路：多项目，每个项目独立版本历史

**对话式编程体现：**
- 用户通过使用发现问题
- 实时讨论解决方案
- AI理解需求并设计实现方案

---

### 💬 对话片段 #11 - API切换过程

**User (1547):**
```
换一个模型 gemini-3-pro-image
```

**User (1547):**
```
我改了一下，使用这个，然后文档在 https://www.volcengine.com/docs/82379/1824121?lang=zh 你可以用 google mcp 看看
```

**技术迁移：**
- 从Gemini切换到火山引擎Seedream
- AI阅读官方文档
- 实时调整API调用逻辑

---

### 💬 对话片段 #12 - 调试过程

**User (1547):**
```
程序似乎没能够正确调用 api，前端发送到 generate 的是 http://localhost:5173/api/v1/generate {"user_input":"请你帮我画一个二次元狐狸娘，坐在海边的座椅上，背对着镜头，看着远处的日落"} 而且 env 设置好了，看看？
```

**User (1547):**
```
{"detail":"内部错误: No module named 'google'"} gemini 也是中转的，要设置成 模型选择
```

**调试过程展示：**
- 🐛 发现API调用失败
- 🔧 排查依赖问题
- 🔄 调整模型配置

---

### 💬 对话片段 #13 - 使用OpenAI SDK

**User (1547):**
```
等一下，其实可以用 openai sdk
import os
from openai import OpenAI

client = OpenAI(
    base_url="https://ark.cn-beijing.volces.com/api/v3",
    api_key=os.environ.get("ARK_API_KEY"),
)

imagesResponse = client.images.generate(
    model="doubao-seedream-4-0-250828",
    prompt="...",
    size="2K",
    response_format="url",
    extra_body={
        "watermark": True,
    },
)

方式类似
```

**User (1547):**
```
然后更新一下吧
```

**技术方案优化：**
- 采用OpenAI SDK统一接口
- 简化API调用代码
- 提高代码可维护性

---

## 阶段5：Prompt工程优化

### 💬 对话片段 #14 - Prompt优化需求

**User (1547):**
```
然后你看眼目前我们 prompt 生成的部分和火山推荐的 prompt 风格，看看能不能优化一下 prompt 的一些生成逻辑？
```

**Prompt工程体现：**
- 📚 研究目标API的Prompt最佳实践
- 🔧 优化Prompt生成逻辑
- 🎯 对齐官方推荐风格

---

### 💬 对话片段 #15 - 功能优化建议

**User (1547):**
```
然后我建议前端点生成的时候先让后端返回文字，后让前端确认后开始画图。这样子可以省钱也可以让用户直接二次修改，看看怎么实现
```

**用户体验优化：**
- 💡 创新功能：Prompt预览
- 💰 成本优化：确认后再生成图片
- ✏️ 用户控制：可二次修改Prompt

**对话式编程体现：**
- 用户提出优化想法
- AI理解需求并设计实现方案
- 体现产品思维和成本意识

---

### 💬 对话片段 #16 - 项目成功！

**User (1547):**
```
我艹！谢谢你 48！这个项目完全成功了！
```

**里程碑时刻：**
- ✅ API调用成功
- ✅ 图片生成正常
- ✅ 核心功能打通

---

### 💬 对话片段 #17 - 持续优化

**User (1547):**
```
调查一下一个 bug INFO: 127.0.0.1:56082 - "POST /api/v1/feedback HTTP/1.1" 422 Unprocessable Entity
前端返回的是 {"version":2,"feedback":"AI 味道有点重，请你优化一下，主要是脸部用的色彩太诡异了"}
```

**User (1547):**
```
前端是这样的 Request URL http://localhost:5173/api/v1/sessions/undefined/feedback
看看是不是没能获取到 ID，是反馈优化那部分
```

**持续迭代：**
- 🐛 发现反馈功能bug
- 🔍 定位问题：session_id未传递
- 🔧 修复并优化

---

## 关键技术决策总结

### 🎯 Prompt工程演进过程

1. **初始阶段**：简单的用户输入透传
2. **优化阶段1**：添加LLM中间层优化
3. **优化阶段2**：引入RAG（固定提示词模版）
4. **优化阶段3**：对齐Seedream官方Prompt风格
5. **最终方案**：Prompt预览 + 用户确认机制

### 🔄 模型推理链路设计

```
用户输入
  ↓
LLM优化层 (GPT-4o + RAG模版)
  ↓
优化后的Prompt (预览&确认)
  ↓
图像生成API (Seedream)
  ↓
反馈优化循环
```

### 📊 技术栈演进

| 组件 | 初始方案 | 最终方案 | 变更原因 |
|------|---------|---------|---------|
| 数据库 | PostgreSQL | SQLite | 降低部署复杂度 |
| 图像API | Gemini | 火山Seedream | 更稳定的中文支持 |
| API调用 | 自定义HTTP | OpenAI SDK | 统一接口，易维护 |
| 前端样式 | 基础组件 | 优化后UI | 提升专业度 |

### 💡 对话式编程的价值体现

1. **需求理解**：通过多轮对话澄清项目定位
2. **技术选型**：协作决策，灵活调整
3. **问题诊断**：实时反馈，快速定位
4. **迭代优化**：持续改进，追求完美
5. **知识传递**：AI阅读文档，快速集成新API

---

## 📈 统计数据

- **总对话轮次**: 97条
- **主要开发阶段**: 5个
- **技术栈调整**: 4次重大决策
- **Bug修复**: 8+ 次调试过程
- **功能迭代**: 3次重大功能增强

---

## 🎬 路演建议

### PPT结构建议

1. **开场**（1分钟）
   - 项目名称：PRISM - Prompt优化中间层
   - 核心价值：让普通用户也能写出专业级Prompt

2. **系统架构与LLM调用设计**（1.5分钟）
   - 展示模型推理链路图
   - 说明RAG + LLM优化的技术方案

3. **对话式编程过程展示**（2.5分钟） ⭐ **重点**
   - **案例1**：UI迭代优化（截图对比）
   - **案例2**：API切换过程（展示如何让AI阅读文档）
   - **案例3**：Prompt工程优化（展示Prompt演进）
   - 强调：通过对话完成技术选型→实现→调试→优化全流程

4. **Demo演示**（1.5分钟）
   - 现场演示：输入简单描述→AI优化Prompt→预览→生成图片→反馈优化

5. **未来扩展**（0.5分钟）
   - 支持更多图像生成模型
   - Prompt模版市场
   - 多模态输入（图生图优化）

### 演示脚本示例

```
"让我展示一个真实的开发场景：

我们在集成火山引擎API时遇到了问题。我通过对话告诉AI：'文档在这个URL，用MCP看看'。
AI立即阅读了官方文档，理解了API格式，然后建议我们使用OpenAI SDK来简化调用。
这就是对话式编程的威力——AI不仅是代码生成器，更是技术顾问。

整个过程中，我们进行了97轮对话，完成了从需求讨论、技术选型、UI优化到API集成的全流程。
每一次技术决策，都是通过对话协作完成的。"
```

---

*本文档基于 filtered_prism_conversations.md 整理，展示了真实的对话式编程开发过程*
